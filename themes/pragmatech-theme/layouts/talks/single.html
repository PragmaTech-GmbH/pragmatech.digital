{{ define "main" }}
<article class="bg-slate-900">
    <div class="max-w-5xl mx-auto px-4 py-8">
        <div class="mb-8">
            <a href="/talks/" class="text-brand-400 hover:text-brand-300 flex items-center">
                <i class="fas fa-arrow-left mr-2"></i>
                Back to Speaking Engagements
            </a>
        </div>

        <header class="mb-12">
            <div class="flex items-center mb-4">
                <div class="text-brand-400 mr-4">
                    <i class="fas fa-microphone text-5xl"></i>
                </div>
                <div>
                    <h1 class="text-4xl font-bold text-white">{{ .Title }}</h1>
                    <div class="text-lg text-slate-400 mt-2">
                        {{ .Params.duration }}
                        {{ if .Params.venues_delivered }}
                        • {{ len .Params.venues_delivered }} previous deliveries
                        {{ end }}
                    </div>
                </div>
            </div>
        </header>

        <!-- Details Section -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-12 mb-20 mt-16">
            <div class="md:col-span-2">
                <div class="prose prose-invert prose-lg max-w-none page-content text-slate-300">
                    {{ .Content }}
                </div>

                <!-- Abstract -->
                {{ if .Params.abstract }}
                <div class="mt-12">
                    <h2 class="text-2xl font-bold mb-6 text-white">Talk Abstract</h2>
                    <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
                        <p class="text-lg text-slate-300">{{ .Params.abstract | safeHTML }}</p>
                    </div>
                </div>
                {{ end }}

                <!-- Key Takeaways -->
                {{ if .Params.key_takeaways }}
                <div class="mt-12">
                    <h2 class="text-2xl font-bold mb-6 text-white">What You'll Learn</h2>
                    <ul class="space-y-4">
                        {{ range .Params.key_takeaways }}
                        <li class="flex items-start">
                            <i class="fas fa-check-circle text-brand-400 mr-3 mt-1"></i>
                            <span class="text-slate-300">{{ . }}</span>
                        </li>
                        {{ end }}
                    </ul>
                </div>
                {{ end }}

                <!-- Prerequisites -->
                {{ if .Params.prerequisites }}
                <div class="mt-12">
                    <h2 class="text-2xl font-bold mb-6 text-white">Prerequisites</h2>
                    <ul class="space-y-3">
                        {{ range .Params.prerequisites }}
                        <li class="flex items-start">
                            <i class="fas fa-info-circle text-slate-500 mr-3 mt-1"></i>
                            <span class="text-slate-300">{{ . }}</span>
                        </li>
                        {{ end }}
                    </ul>
                </div>
                {{ end }}

                <!-- Resources -->
                {{ if or .Params.slides_url .Params.video_url .Params.github_url }}
                <div class="mt-12">
                    <h2 class="text-2xl font-bold mb-6 text-white">Resources</h2>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        {{ if .Params.slides_url }}
                        <a href="{{ .Params.slides_url }}" target="_blank" class="flex items-center p-4 bg-slate-800 rounded-lg border border-slate-700 hover:border-brand-500/50 transition-colors">
                            <i class="fas fa-file-powerpoint text-brand-400 text-2xl mr-3"></i>
                            <div>
                                <div class="font-bold text-white">Slides</div>
                                <div class="text-sm text-slate-400">View presentation</div>
                            </div>
                        </a>
                        {{ end }}

                        {{ if .Params.video_url }}
                        <a href="{{ .Params.video_url }}" target="_blank" class="flex items-center p-4 bg-slate-800 rounded-lg border border-slate-700 hover:border-brand-500/50 transition-colors">
                            <i class="fas fa-video text-brand-400 text-2xl mr-3"></i>
                            <div>
                                <div class="font-bold text-white">Recording</div>
                                <div class="text-sm text-slate-400">Watch talk</div>
                            </div>
                        </a>
                        {{ end }}

                        {{ if .Params.github_url }}
                        <a href="{{ .Params.github_url }}" target="_blank" class="flex items-center p-4 bg-slate-800 rounded-lg border border-slate-700 hover:border-brand-500/50 transition-colors">
                            <i class="fab fa-github text-brand-400 text-2xl mr-3"></i>
                            <div>
                                <div class="font-bold text-white">Code</div>
                                <div class="text-sm text-slate-400">GitHub repository</div>
                            </div>
                        </a>
                        {{ end }}
                    </div>
                </div>
                {{ end }}

                <!-- Delivery History -->
                {{ if .Params.venues_delivered }}
                <div class="mt-12">
                    <h2 class="text-2xl font-bold mb-6 text-white">Delivery History</h2>
                    <div class="space-y-4">
                        {{ range .Params.venues_delivered }}
                        <div class="border border-slate-700 rounded-lg p-4 bg-slate-800">
                            <div class="flex justify-between items-start mb-2">
                                <h3 class="font-bold text-lg text-white">{{ .name }}</h3>
                                <span class="bg-brand-500/20 text-brand-400 text-xs px-2 py-1 rounded-full capitalize">{{ .type }}</span>
                            </div>
                            <div class="text-slate-400 mb-1">{{ .location }}</div>
                            <div class="flex justify-between text-sm text-slate-500">
                                <span>{{ dateFormat "January 2, 2006" .date }}</span>
                                {{ if .attendees }}<span>{{ .attendees }} attendees</span>{{ end }}
                            </div>
                        </div>
                        {{ end }}
                    </div>
                </div>
                {{ end }}
            </div>

            <div>
                <div class="bg-slate-800 rounded-xl p-6 border border-slate-700 sticky top-24">
                    <h3 class="text-xl font-bold mb-4 text-white">Book This Talk</h3>
                    <a href="/contact" class="block w-full bg-brand-600 text-white hover:bg-brand-500 font-bold py-3 px-6 rounded-lg transition-colors text-center mb-4">
                        Request Speaking Engagement
                    </a>

                    <div class="text-sm text-slate-400 mb-6">
                        We'll discuss your event requirements and customize the presentation for your audience.
                    </div>

                    {{ if .Params.topics }}
                    <h4 class="font-bold mb-3 text-white">Topics Covered:</h4>
                    <div class="flex flex-wrap gap-2 mb-6">
                        {{ range .Params.topics }}
                        <span class="bg-brand-500/20 text-brand-400 text-xs px-2 py-1 rounded-full">{{ . }}</span>
                        {{ end }}
                    </div>
                    {{ end }}

                    {{ if .Params.target_audience }}
                    <h4 class="font-bold mb-3 text-white">Target Audience:</h4>
                    <ul class="space-y-2 mb-6">
                        {{ range .Params.target_audience }}
                        <li class="flex items-start">
                            <i class="fas fa-user text-brand-400 mr-2 mt-1 text-xs"></i>
                            <span class="text-sm text-slate-300">{{ . }}</span>
                        </li>
                        {{ end }}
                    </ul>
                    {{ end }}

                    {{ if .Params.available_for }}
                    <h4 class="font-bold mb-3 text-white">Available For:</h4>
                    <div class="flex flex-wrap gap-2 mb-6">
                        {{ range .Params.available_for }}
                        <span class="bg-slate-700 text-slate-300 text-xs px-2 py-1 rounded-full capitalize">{{ replace . "_" " " }}</span>
                        {{ end }}
                    </div>
                    {{ end }}

                    <div class="border-t border-slate-700 pt-4">
                        <div class="font-bold mb-2 text-white">Have questions?</div>
                        <a href="/contact" class="text-brand-400 hover:text-brand-300">Contact us</a>
                    </div>
                </div>
            </div>
        </div>

        <!-- CTA -->
        <div class="bg-gradient-to-r from-brand-600 to-brand-500 text-white rounded-xl p-8 mb-20 mt-8">
            <div class="text-center">
                <h2 class="text-2xl font-bold mb-4">Ready to bring this talk to your event?</h2>
                <a href="/contact" class="inline-block bg-white text-brand-600 hover:bg-slate-100 font-bold py-3 px-8 rounded-lg transition-colors mt-4">
                    Request Speaking Engagement
                </a>
            </div>
        </div>

        <!-- Related Talks -->
        {{ $current := . }}
        {{ $related := where (where .Site.RegularPages "Section" "talks") "Permalink" "ne" .Permalink | first 3 }}
        {{ if $related }}
        <div class="mt-24 pt-12 border-t border-slate-700">
            <h2 class="text-2xl font-bold mb-6 text-white">Related Talks</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                {{ range $related }}
                <div class="bg-slate-800 rounded-lg border border-slate-700 overflow-hidden hover:border-brand-500/50 transition-colors">
                    <div class="p-6">
                        <div class="text-brand-400 mb-3">
                            <i class="fas fa-microphone text-3xl"></i>
                        </div>
                        <h3 class="font-bold text-xl mb-2 text-white">
                            <a href="{{ .Permalink }}" class="hover:text-brand-400 transition-colors">{{ .Title }}</a>
                        </h3>
                        <p class="text-slate-400 mb-4 text-sm">{{ .Params.abstract | truncate 100 }}</p>
                        <div class="text-xs text-slate-500 mb-3">
                            {{ .Params.duration }}
                            {{ if .Params.venues_delivered }}
                            • {{ len .Params.venues_delivered }} deliveries
                            {{ end }}
                        </div>
                        <a href="{{ .Permalink }}" class="text-brand-400 text-sm hover:text-brand-300">Learn more →</a>
                    </div>
                </div>
                {{ end }}
            </div>
        </div>
        {{ end }}
    </div>
</article>
{{ end }}
